#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...
source $HOME/.zshenv
source $HOME/.zprezto/docker.zsh
source $HOME/.zprezto/iterm2_shell_integration.zsh # load in iterm shell integration

if [ $commands[kubectl] ]; then
  source <(kubectl completion zsh)
fi

#source /usr/local/etc/bash_completion.d
source /usr/local/share/zsh/site-functions

PATH=$PATH:$JAVA_HOME
PATH=$PATH:$M2_HOME

PATH=$PATH:$ISTIO_PATH
PATH=$PATH:$ISTIO_BIN

PATH=$PATH:$GCLOUD_BIN

PATH=$PATH:$CARGO_BIN
PATH=$PATH:$GOBIN
PATH=$PATH:$GOROOT_BIN
PATH=$PATH:$GOPATH
PATH=$PATH:$KREW_BIN

PATH=$PATH:$PYTHON_LOCAL_BIN

PATH=$PATH:$LOCAL_BIN
PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools
PATH=$PATH:$FLUTTER_BIN

export PATH

gen_random_string () {
	local val=$(LC_CTYPE=C tr -cd "a-z0-9" < /dev/urandom | tr -dc '[:alnum:]' | fold -w 6 | head -n 1)
  echo "$val"
}

troubleshoot_pod () {
  pod_suffix=$(gen_random_string)
	pod_name="troubleshooting-amargherio-${pod_suffix}"
	kubectl run "$pod_name" -i --tty --image="tcartifactory-docker.jfrog.io/ops/ops-toolkit:1.0.0" -n infra --restart=Never --overrides='{ "apiVersion": "v1", "spec": { "imagePullSecrets": [{"name": "artifactory"}] } }' -- bash

  kubectl delete po -n infra "$pod_name"
}


alias vi=nvim
alias vim=nvim
#alias kcep=kubectl get pods -o json | jq '.items[] | select(.status.reason!=null) | select(.status.reason | contains("Evicted")) | "kubectl delete po \(.metadata.name) -n \(.metadata.namespace)"' | xargs -n 1 bash -c
alias ls=exa
alias grep=rg
